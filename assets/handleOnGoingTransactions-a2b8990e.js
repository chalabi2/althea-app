import{D as l,ao as E,b2 as A,b3 as N,B as c,u as m,b4 as R,H as h,j as b,aJ as T,m as i,ax as g,b5 as y,a$ as L,af as S,aD as x,M as I,aY as P,y as M}from"./index-ac4b7cfd.js";import{T as v,_ as W,c as U}from"./ongoingTxModal-14d337f5.js";function C(t,e){const r=l.useRef(t);l.useEffect(()=>{r.current=t},[t]),l.useEffect(()=>{if(e===null)return;const n=setInterval(()=>r.current(),e);return()=>clearInterval(n)},[e])}function F(t,e){if(e===0)return[];const r=n=>Date.now()-n;return t.filter(n=>r(n.submittedAt)>=e)}function j(){const{chainId:t,account:e}=E(),{addNotification:r,notifications:n,removeNotification:a}=A(),{notifications:{checkInterval:s,expirationPeriod:o}}=N(),u=l.useMemo(()=>{var f;return t===void 0||!e?[]:(f=n[t])!==null&&f!==void 0?f:[]},[n,t,e]);return C(()=>{if(!t)return;const f=F(u,o);for(const d of f)a({notificationId:d.id,chainId:t})},s),{notifications:u,addNotification:r,removeNotification:a}}const O="/althea-app/assets/note-6c6dc727.svg";function G(t,e){return!t||!e?[c.from(1),!0]:t.gte(e)?[t.mul(c.from(10).pow(18)).div(e),!0]:[e.mul(c.from(10).pow(18)).div(t),!1]}function D(t,e,r){return r?t.mul(c.from(10).pow(18)).div(e):t.mul(e).div(c.from(10).pow(18))}function Y(t,e,r){return r?t.mul(e).div(c.from(10).pow(18)):t.mul(c.from(10).pow(18)).div(e)}function J(t,e,r){return m.formatUnits(r.mul(m.parseUnits(R(t.toString()))).add(e.mul(c.from(10).pow(18))).div(r.add(e)).mul(100))}function q(t,e,r,n){const a=Y(e,r,n);return a.gt(t)?t:a}function K(t,e,r,n){const a=D(t,r,n);return a.gt(e)?e:a}function Q(t,e,r,n){return e?1/Number(m.formatUnits(t,18+r-n)):Number(m.formatUnits(t,18+n-r))}function X(t,e){return e.mul(t).div(c.from(10).pow(18))}function z(t,e){if(e<=0||isNaN(e))return c.from(0);const r=m.parseUnits(h(e.toString(),18),18);return t.mul(r).div(m.parseUnits("1",20))}function tt(t){return`${t.stable?"s":"v"}-${t.token1.symbol}/${t.token2.symbol}`}const et=({width:t,height:e,padding:r,token:n})=>((!e||!t)&&(t=20),r||(r=4),b("img",{src:n=="althea"?T:O,width:t,style:{padding:`0 ${r+"px"}`},height:e,alt:"note token"}));async function rt(t,e,r,n,a,s){if(!r)return e.setStatus({error:"No account found"}),!1;const o=s.lte(a),u=[];return o&&u.push({chainId:t,txType:i.DRIP,address:g(t).Reservoir,abi:y,method:"drip",params:[],value:"0"}),u.push({chainId:t,txType:i.CLAIM_REWARDS_LENDING,address:n,abi:L,method:"claimComp",params:[r],value:"0",extraDetails:{symbol:"WALTHEA",icon:S.altheaMainnet.ALTHEA.icon,amount:m.formatUnits(a,18)}}),await e.addTransactionList(u,{title:"Claim Lending Rewards",txListMethod:v.EVM,chainId:t})}async function nt(t,e,r,n,a){if(!t)return e.setStatus({error:"No chainId found"}),!1;const s=n.data.underlying.symbol==="ALTHEA",o={symbol:n.data.underlying.symbol,icon:n.data.underlying.icon,amount:m.formatUnits(a,n.data.underlying.decimals)},u=[];switch(r){case i.SUPPLY:case i.REPAY:case i.BORROW:case i.WITHDRAW:(r===i.SUPPLY||r===i.REPAY)&&!s&&u.push(W(t,n.data.underlying.address,n.data.address,a,n.allowance,o)),u.push(H(t,r,n.data.address,s,a,o));break;case i.COLLATERALIZE:case i.DECOLLATERLIZE:u.push(Z(t,g(t).Comptroller,n.data.address,r===i.COLLATERALIZE,o));break;default:return!1}return await e.addTransactionList(u,{title:r,txListMethod:v.EVM,chainId:t})}const H=(t,e,r,n,a,s)=>({chainId:t,txType:e,address:r,abi:x,method:_(e,n),...k(e,n,a),extraDetails:s}),Z=(t,e,r,n,a)=>({chainId:t,txType:n?i.COLLATERALIZE:i.DECOLLATERLIZE,address:e,abi:L,method:n?"enterMarkets":"exitMarket",params:n?[[r]]:[r],value:"0",extraDetails:a});function _(t,e){switch(t){case i.SUPPLY:return e?"mint()":"mint(uint256)";case i.REPAY:return e?"repayBorrow()":"repayBorrow(uint256)";case i.BORROW:return"borrow";case i.WITHDRAW:return"redeem";default:return""}}function k(t,e,r){switch(t){case i.SUPPLY:case i.REPAY:return e?{params:[],value:r}:{params:[r],value:"0"};case i.BORROW:case i.WITHDRAW:return{params:[r],value:"0"};default:return{params:[],value:"0"}}}function at(t,e){return t.mul(e).div(c.from(10).pow(18))}function p(t,e,r,n,a){if(r.isZero()||a.isZero())return I;if(n==0)return c.from(0);const s=e.sub(t.mul(100).div(n)).mul(c.from(10).pow(36)).div(r.mul(a));return s.isNegative()?c.from(0):s}function st(t,e,r,n,a,s){return t.isZero()?!1:p(t,e,r,n,s).lt(a)}function $(t,e,r,n,a){const o=e.mul(n).div(c.from(10).pow(18)).mul(r).div(c.from(10).pow(18)),u=t?a.add(o):a.sub(o);return u.gte(0)?u:c.from(0)}function it(t,e,r,n,a,s){const o=$(t,e,r,n,a);return o.lte(0)?0:P(s,o)}function ot(t,e,r,n,a,s){if(s){const o=p(e,r,n,80,a),u=p(e,r,n,100,a),f=t.lte(o),d=t.lte(u);return f?[t,t,!0]:d?[o,t,!1]:[o,u,!1]}else return[t,t,!0]}const ut=(t,e,r)=>{l.useEffect(()=>{let n=e;for(const a of t)a.type=="transactionStarted"&&!n.find(s=>s.id==a.id)?n.push({...a}):(a.type=="transactionSucceed"||a.type=="transactionFailed")&&(n=n.filter(s=>!(s.type=="transactionStarted"&&s.transaction.hash==a.transaction.hash))),r(n);t.map((a,s)=>{var o;if((o=a==null?void 0:a.transactionName)!=null&&o.includes("type")&&a.type=="transactionSucceed"||a.type=="transactionFailed"){const u=a.type!="transactionFailed",f=JSON.parse(a==null?void 0:a.transactionName),d=U(s.toString(),f.type).messages.long,w=`${u?"":"un"}successfully ${d}`;M(w,u,a.id)}})},[t])};export{et as T,H as _,q as a,D as b,K as c,Y as d,z as e,tt as f,Q as g,J as h,G as i,at as j,ut as k,nt as l,rt as m,O as n,$ as o,it as p,ot as q,j as u,X as v,st as w};
